"use strict";(self.webpackChunkbill_splitter=self.webpackChunkbill_splitter||[]).push([[50],{3050:(e,t,s)=>{s.r(t),s.d(t,{default:()=>o});var a=s(5043),r=s(9938),n=s.n(r),i=s(7835),c=s(3216),l=s(579);const o=function(){const[e,t]=(0,a.useState)(null),[s,r]=(0,a.useState)(""),[o,u]=(0,a.useState)(!1),[d,h]=(0,a.useState)([]),[p,g]=(0,a.useState)(null),[x,m]=(0,a.useState)(""),[v,j]=(0,a.useState)(""),[f,w]=(0,a.useState)(""),b=(0,a.useRef)(null),y=(0,a.useRef)(null),S=(0,a.useRef)(null),k=(0,c.Zp)();(0,a.useEffect)((()=>{e||C()}),[e]);const C=async()=>{try{const e=await navigator.mediaDevices.getUserMedia({video:!0});S.current=e,b.current&&(b.current.srcObject=e)}catch(e){console.error("Error accessing the camera: ",e)}},R=e=>{u(!0),n().recognize(e,"eng",{logger:e=>console.log(e)}).then((e=>{let{data:{text:t}}=e;r(t),u(!1)})).catch((e=>{console.error("Error during OCR: ",e),u(!1)}))};return(0,l.jsxs)("div",{className:"receipt-editor",style:{maxHeight:"100vh",overflowY:"auto",paddingBottom:"100px"},children:[(0,l.jsx)("h2",{children:"Scan Receipt"}),e?(0,l.jsxs)("div",{className:"captured-image-container",children:[(0,l.jsx)("h3",{children:"Captured Image"}),(0,l.jsx)("img",{src:e,alt:"Captured Receipt",className:"captured-image"}),(0,l.jsx)("button",{onClick:()=>{t(null),r(""),h([])},className:"retake-button",children:"Retake"}),o?(0,l.jsx)("p",{children:"Processing the image, please wait..."}):(0,l.jsxs)("div",{className:"extracted-text",children:[(0,l.jsx)("h3",{children:"Extracted Receipt:"}),(0,l.jsx)("pre",{children:s})]}),(0,l.jsx)(i.BI,{width:500,height:500,onMouseDown:e=>{const{offsetX:t,offsetY:s}=e.evt;g({x:t,y:s,width:0,height:0})},onMouseMove:e=>{if(p){const{offsetX:t,offsetY:s}=e.evt;g((e=>({...e,width:t-e.x,height:s-e.y})))}},onMouseUp:()=>{p&&(h((e=>[...e,p])),g(null))},children:(0,l.jsxs)(i.Wd,{children:[d.map(((e,t)=>(0,l.jsx)(i.rw,{x:e.x,y:e.y,width:e.width,height:e.height,stroke:"red"},t))),p&&(0,l.jsx)(i.rw,{x:p.x,y:p.y,width:p.width,height:p.height,stroke:"blue"})]})}),(0,l.jsxs)("div",{className:"receipt-details-form",children:[(0,l.jsx)("h3",{children:"Receipt Details"}),(0,l.jsxs)("label",{children:["Restaurant:",(0,l.jsx)("input",{type:"text",value:x,onChange:e=>m(e.target.value)})]}),(0,l.jsxs)("label",{children:["Amount:",(0,l.jsx)("input",{type:"number",value:v,onChange:e=>j(e.target.value)})]}),(0,l.jsxs)("label",{children:["Friends (comma-separated):",(0,l.jsx)("input",{type:"text",value:f,onChange:e=>w(e.target.value)})]})]}),(0,l.jsx)("button",{onClick:()=>{const t={id:Date.now(),date:(new Date).toISOString().split("T")[0],restaurant:x||"Unknown",amount:parseFloat(v)||0,friends:f?f.split(",").map((e=>e.trim())):[],status:"Unpaid",image:e,annotations:d,extractedText:s},a=JSON.parse(localStorage.getItem("receipts"))||[];a.push(t),localStorage.setItem("receipts",JSON.stringify(a)),k("/bills")},className:"save-receipt-button",style:{marginTop:"20px"},children:"Save Receipt"})]}):(0,l.jsxs)("div",{className:"camera-feed",children:[(0,l.jsx)("video",{ref:b,autoPlay:!0,className:"camera-video"}),(0,l.jsx)("button",{onClick:()=>{if(y.current&&b.current){const e=y.current.getContext("2d");y.current.width=b.current.videoWidth,y.current.height=b.current.videoHeight,e.drawImage(b.current,0,0,b.current.videoWidth,b.current.videoHeight);const s=y.current.toDataURL("image/png");t(s),S.current&&S.current.getTracks().forEach((e=>e.stop())),R(s)}},className:"capture-button",children:"Capture Receipt"})]}),(0,l.jsx)("canvas",{ref:y,style:{display:"none"}})]})}}}]);
//# sourceMappingURL=50.fb621f9b.chunk.js.map